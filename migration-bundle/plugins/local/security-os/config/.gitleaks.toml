title = "Shadow Security OS - Gitleaks Config"

[extend]
# Extend default rules

[[rules]]
id = "supabase-service-role-key"
description = "Supabase Service Role Key"
regex = '''eyJ[A-Za-z0-9_-]*\.eyJ[A-Za-z0-9_-]*\.[A-Za-z0-9_-]*'''
keywords = ["service_role", "supabase"]
tags = ["supabase", "jwt"]

[[rules]]
id = "supabase-anon-key"
description = "Supabase Anon Key (public but track)"
regex = '''eyJ[A-Za-z0-9_-]{20,}\.eyJ[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{20,}'''
keywords = ["anon", "supabase"]
tags = ["supabase", "jwt"]

[[rules]]
id = "vercel-token"
description = "Vercel Authentication Token"
regex = '''[A-Za-z0-9]{24}'''
keywords = ["vercel", "token"]
tags = ["vercel"]

[[rules]]
id = "anthropic-api-key"
description = "Anthropic Claude API Key"
regex = '''sk-ant-[A-Za-z0-9_-]{20,}'''
tags = ["anthropic", "api-key"]

[[rules]]
id = "generic-password-assignment"
description = "Hardcoded password assignment"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*['\"][^\s'"]{8,}['\"]'''
tags = ["password"]

[allowlist]
paths = [
  '''node_modules''',
  '''\.next''',
  '''dist''',
  '''build''',
  '''\.env\.example''',
  '''\.env\.template''',
  '''package-lock\.json''',
]
